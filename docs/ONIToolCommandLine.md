<style type="text/css">@page { size: landscape; margin: 0.5in; }</style>

# MOVES ONI Tool Command Line Interface

The MOVES off-network idle (ONI) Tool can assist MOVES users who generate inventories by running MOVES at the County Scale in Emission Rates mode and multiply those rates by activity outside of MOVES. For more detail about what ONI is, how MOVES uses it, and how to use it in generating inventories, see the [instructions for using the ONI Tool in the MOVES GUI](https://github.com/USEPA/EPA_MOVES_Model/blob/master/database/ONITool/InstructionsForONITool.pdf). 

The ONI Tool has been added to Ant, the MOVES dependency manager and command line interface tool. This document includes specific examples on how to use the ONI Tool through the command line. For general information on MOVES' command line tools, see [CommandLineMOVES.md](https://github.com/USEPA/EPA_MOVES_Model/blob/master/docs/CommandLineMOVES.md).

## Prerequisites

In order to use the ONI Tool, users must first have a county database (CDB) and MOVES version 3.0.2 or greater must be installed. The ONI Tool assumes the CDB has already been built using the MOVES County Data Manager or some other method and is complete. If it is not complete, the ONI Tool will fail. Likewise, the ONI Tool will not aid in the creation or population of CDB.

## Command Line Interface

To use MOVES' command line tools, first open the Windows command prompt and navigate to the MOVES directory. Then, run the command `setenv`. For more information on using MOVES' command line tools, see [CommandLineMOVES.md](https://github.com/USEPA/EPA_MOVES_Model/blob/master/docs/CommandLineMOVES.md).

The Ant command to run the ONI Tool is `oniTool`. It only takes one input, passed via the flat `-Dinput`. There are three types of input allowed:

1. A single input database:  
   `ant oniTool -Dinput=c12345y2020_20210504`

2. A comma-separated list of databases, wrapped in quotes:  
   `ant oniTool -Dinput="c12345y2020_20210504,c23456y2020_20210504"`
3. A .txt file with a list of databases, one on each line:  
   `ant oniTool -Dinput=db_list.txt`

For input option #3 above, databases need to be separated by a new line. The following would be a valid `db_list.txt` file:

```
c12345y2020_20210504
c23456y2020_20210504
```

## Output

The MOVES ONI Tool command line interface is meant to be used when users need to get ONI activity for multiple CDBs and want to use the output in a systematic way, such as in a data analysis script. The ONI interface in the GUI is still the preferred option for users who only need to run the ONI Tool on a single CDB. 

Because of the different use cases, the output generated from the command line interface is stored differently from the output generated by the GUI interface. When run via the GUI, the tool writes the results to a file, given by the user. However, the ONI Tool *does not* write to file when run from the command line. Instead, it creates a new table in the CDB, called `onitooloutput`, which has the same structure as the output file.

### Output Table Definition

The `onitooloutput` table is the same as the output file written when the ONI Tool is run via the MOVES GUI. For the integer columns, definitions can be found in [MOVESGlossary.md](https://github.com/USEPA/EPA_MOVES_Model/blob/master/docs/CommandLineMOVES.md).

| Field                              | Type        | Description                                                  |
| ---------------------------------- | ----------- | ------------------------------------------------------------ |
| yearID                             | SMALLINT(6) |                                                              |
| monthID                            | SMALLINT(6) |                                                              |
| dayID                              | SMALLINT(6) |                                                              |
| hourID                             | SMALLINT(6) |                                                              |
| sourceTypeID                       | SMALLINT(6) |                                                              |
| minModelYearID                     | INT(11)     |                                                              |
| maxModelYearID                     | INT(11)     |                                                              |
| onroadSHO (hr)                     | DOUBLE      | Total onroad Source Hours Operating that would be calculated by a MOVES Inventory Mode run |
| VMT (mi)                           | DOUBLE      | Total vehicle miles travelled that would be calculated by a MOVES Inventory Mode run |
| ONI (hr)                           | DOUBLE      | Total off-network idle hours that would be calculated by a MOVES Inventory Mode run |
| ONI per VMT (hr idle/mi)           | DOUBLE      | ONI hours per VMT, which can be used to calculate ONI hours from VMT estimates that are different from what is provided in the CDB |
| ONI per SHO (hr idle/hr operating) | DOUBLE      | ONI hours per VMT, which can be used to calculate ONI hours from VMT estimates that are different from what is provided in the CDB |

